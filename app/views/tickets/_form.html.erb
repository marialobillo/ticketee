<%= form_for [@project, @ticket], html: { multipart: true } do |f| %>
  <% if @ticket.errors.any? %>
  <div id="error_explanation">
    <h2><%= pluralize(@ticket.errors.count, "error") %>
        prohibited this ticket from being saved:</h2>

    <ul>
      <% @ticket.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<p>
  <%= f.label :title %><br>
  <%= f.text_field :title %>
</p>

<p>
  <%= f.label :description %>
  <%= f.text_area :description %>
</p>

<% number = 0 %>
<%= f.fields_for :assets do |asset| %>
  <p>
    <%= asset.label :asset, "File ##{number += 1}" %>
    <%= asset.file_field :asset %>
  </p>
<% end %>

<p>

<p>
  <%= link_to "Add another file", new_file_path,
      :remote => true,
      :update => "files",
      :position => "after" %>
</p>
<div id="files">
  <%= f.fields_for :assets, :child_index => number do |asset| %>
    <p>
      <%= asset.label :asset, "File ##{number += 1}" %>
      <%= asset.file_field :asset %>
    </p>
  <% end %>
</div>
  <%= f.submit %>
</p>
<% end %>
